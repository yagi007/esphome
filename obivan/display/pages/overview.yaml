# =============================================================================
# OVERVIEW PAGE - Hlavní dashboard stránka
# Based on bennydiamond/esphome_lvgl_hmi_garage structure
# Kombinuje všechny komponenty: header, battery, energy flow, navigation
# =============================================================================

# LVGL stránka
lvgl:
  pages:
    - id: page_overview
      bg_color: 0x000000 # Jednotné černé pozadí
      scrollbar_mode: "OFF"
      scrollable: false
      on_swipe_left:
        - lvgl.page.show: page_mppt
      on_swipe_right:
        - lvgl.page.show: page_settings
      widgets:
        # Jednotné rozhraní: 3 boxy v absolutních pozicích + overlay s linkami
        - obj: #main_container
            id: energy_flow
            width: 100%
            height: 370
            y: 50
            bg_opa: TRANSP
            border_width: 0
            scrollbar_mode: "OFF"
            scrollable: false
            pad_all: 0
            widgets:
              # Levý horní: Solar
              - obj: # solar_card
                  id: solar_card
                  x: 16
                  y: 16
                  width: 200
                  height: 158
                  bg_color: 0x0A0A0A
                  bg_opa: COVER
                  radius: 8
                  pad_all: 10
                  border_width: 1
                  border_color: 0xFF9800
                  widgets:
                    - label:
                        align: TOP_LEFT
                        text: "\U000F1A74"
                        text_font: mdi
                        text_color: 0xFF9800
                    - label:
                        align: TOP_LEFT
                        x: 28
                        text: "Solar"
                        text_font: roboto
                        text_color: 0xFFFFFF
                    - label:
                        id: solar_pv_power
                        align: LEFT_MID
                        y: -10
                        text: "0W"
                        text_font: roboto_big
                        text_color: 0xFF9800
                    - label:
                        id: solar_battery_current
                        align: LEFT_MID
                        y: 15
                        text: "> 0.0A"
                        text_font: roboto
                        text_color: 0x4CAF50
                    - label:
                        id: solar_yield_today
                        align: BOTTOM_RIGHT
                        y: -6
                        text: "0.0kWh"
                        text_font: roboto_sm
                        text_color: 0xCCCCCC

              # Levý dolní: DC/DC
              - obj: # dcdc_card
                  id: dcdc_card
                  x: 16
                  y: 190
                  width: 200
                  height: 158
                  bg_color: 0x0A0A0A
                  bg_opa: COVER
                  radius: 8
                  pad_all: 10
                  border_width: 1
                  border_color: 0x2196F3
                  widgets:
                    - label:
                        align: TOP_LEFT
                        text: "\U000F010B"
                        text_font: mdi
                        text_color: 0x2196F3
                    - label:
                        align: TOP_LEFT
                        x: 28
                        text: "DC/DC"
                        text_font: roboto
                        text_color: 0xFFFFFF
                    - label:
                        id: dcdc_output_power
                        align: LEFT_MID
                        y: -10
                        text: "0W"
                        text_font: roboto_big
                        text_color: 0x2196F3
                    - label:
                        id: dcdc_output_current
                        align: LEFT_MID
                        y: 15
                        text: "> 0.0A"
                        text_font: roboto
                        text_color: 0x4CAF50
                    - label:
                        id: dcdc_efficiency
                        align: BOTTOM_RIGHT
                        y: -6
                        text: "0%"
                        text_font: roboto_sm
                        text_color: 0xCCCCCC

              # Střed: Battery
              - obj: # battery_main_card
                  id: battery_main
                  x: 270
                  y: 16
                  width: 236
                  height: 296
                  bg_color: 0x111111
                  bg_opa: COVER
                  radius: 12
                  pad_all: 16
                  scrollbar_mode: "OFF"
                  scrollable: false
                  border_width: 1
                  border_color: 0xFF5722
                  widgets:
                    - label:
                        align: TOP_LEFT
                        text: "\U000F0079"
                        text_font: mdi
                        text_color: 0xFF5722
                    - label:
                        align: TOP_LEFT
                        x: 28
                        text: "Battery"
                        text_font: roboto
                        text_color: 0xFFFFFF
                    # Battery gauge (bar)
                    - obj:
                        id: battery_gauge_bg
                        align: TOP_LEFT
                        x: 0
                        y: 36
                        width: 204
                        height: 44
                        radius: 6
                        bg_color: 0x222222
                        bg_opa: COVER
                        border_width: 1
                        border_color: 0x333333
                    - obj:
                        id: battery_gauge_fill
                        align: TOP_LEFT
                        x: 0
                        y: 36
                        width: 0
                        height: 44
                        radius: 6
                        bg_color: 0x4CAF50
                        bg_opa: COVER
                        border_width: 0
                    - label:
                        id: soc_percentage
                        align: TOP_MID
                        x: 0
                        y: 48
                        text: "0%"
                        text_font: roboto_big
                        text_color: 0xFFFFFF
                    - label:
                        id: battery_capacity
                        align: TOP_MID
                        x: 0
                        y: 86
                        text: "0/150Ah"
                        text_font: roboto_sm
                        text_color: 0xCCCCCC
                    - label:
                        id: battery_voltage
                        align: BOTTOM_RIGHT
                        x: -10
                        y: -58
                        text: "0.0V"
                        text_font: roboto
                        text_color: 0xFFFFFF
                    - label:
                        id: battery_current
                        align: BOTTOM_RIGHT
                        x: -10
                        y: -34
                        text: "0.0A"
                        text_font: roboto
                        text_color: 0xCCCCCC
                    - label:
                        id: load_daily
                        align: BOTTOM_RIGHT
                        x: -10
                        y: -10
                        text: "0W"
                        text_font: roboto
                        text_color: 0xCCCCCC
                    - label:
                        id: battery_remaining
                        align: BOTTOM_RIGHT
                        x: -10
                        y: -82
                        text: "∞"
                        text_font: roboto
                        text_color: 0xCCCCCC

              # Pravý: Loads
              - obj: # load_card
                  id: load_card
                  x: 560
                  y: 100
                  width: 200
                  height: 158
                  bg_color: 0x0A0A0A
                  bg_opa: COVER
                  radius: 8
                  pad_all: 10
                  border_width: 1
                  border_color: 0x9C27B0
                  widgets:
                    - label:
                        align: TOP_LEFT
                        text: "\U000F0425"
                        text_font: mdi
                        text_color: 0x9C27B0
                    - label:
                        align: TOP_LEFT
                        x: 28
                        text: "Loads"
                        text_font: roboto
                        text_color: 0xFFFFFF
                    - label:
                        id: load_power
                        align: LEFT_MID
                        y: -10
                        text: "0W"
                        text_font: roboto_big
                        text_color: 0x9C27B0
                    - label:
                        id: load_current #  load_current
                        align: LEFT_MID
                        y: 15
                        text: "0.0A <"
                        text_font: roboto
                        text_color: 0xFF5722
                    - label:
                        id: battery_power # load_daily
                        align: BOTTOM_RIGHT
                        y: -6
                        text: "0.0kWh"
                        text_font: roboto_sm
                        text_color: 0xCCCCCC

              # Overlay s jednoduchými linkami (pevné souřadnice)
              - obj:
                  id: flows_overlay
                  width: 100%
                  height: 370
                  y: 50
                  x: 0
                  bg_opa: TRANSP
                  border_width: 0
                  pad_all: 0
                  widgets:
                    - line:
                        id: flow_solar_to_batt
                        line_width: 2
                        line_color: 0x444444
                        points:
                          - x: 216 # pravý okraj solar_card
                            y: 95
                          - x: 270 # levý okraj battery_main
                            y: 95
                    - line:
                        id: flow_dcdc_to_batt
                        line_width: 2
                        line_color: 0x444444
                        points:
                          - x: 216
                            y: 168
                          - x: 270
                            y: 168
                    - line:
                        id: flow_batt_to_load
                        line_width: 2
                        line_color: 0x444444
                        points:
                          - x: 506 # pravý okraj battery_main
                            y: 168
                          - x: 560 # levý okraj load_card
                            y: 168
                    # Koncové bambulky (cílové uzly)
                    - obj:
                        id: dot_solar_batt
                        x: 266
                        y: 91
                        width: 8
                        height: 8
                        radius: 4
                        bg_color: 0x444444
                        bg_opa: COVER
                        border_width: 0
                    - obj:
                        id: dot_dcdc_batt
                        x: 266
                        y: 164
                        width: 8
                        height: 8
                        radius: 4
                        bg_color: 0x444444
                        bg_opa: COVER
                        border_width: 0
                    - obj:
                        id: dot_batt_load
                        x: 556
                        y: 164
                        width: 8
                        height: 8
                        radius: 4
                        bg_color: 0x444444
                        bg_opa: COVER
                        border_width: 0

# =============================================================================
# Navigace přidána přes packages (modulární)
# =============================================================================

# Modulární include headeru (rozšiřuje stránku pomocí !extend)
packages:
  header: !include
    file: ../components/header.yaml
    vars:
      page_id: page_overview
      prefix: ""
  navigation: !include
    file: ../components/navigation.yaml
    vars:
      page_id: page_overview
      prefix: ""
      overview_bg: 0x4CAF50
      overview_text: 0xFFFFFF
      mppt_bg: 0x111111
      mppt_text: 0xCCCCCC
      dcdc_bg: 0x111111
      dcdc_text: 0xCCCCCC
      system_bg: 0x111111
      system_text: 0xCCCCCC
